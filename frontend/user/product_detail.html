<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <title>å•†å“è¯¦æƒ… - Freshbuy åœ¨é²œè´­æ‹¼å¥½è´§</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- å…¬å…±æ ·å¼ -->
    <link rel="stylesheet" href="assets/css/main.css" />
    <style>
      /* ===== è¯¦æƒ…é¡µåŸºç¡€å¸ƒå±€ ===== */
      .detail-page {
        max-width: 1200px;
        margin: 16px auto 40px;
        padding: 0 16px;
      }

      /* ===== è¯¦æƒ…é¡µæ¨èåŒºï¼šæ•´æ’å¡ç‰‡ + å·¦å³ç®­å¤´ ===== */
      .detail-recommend-section {
        position: relative;
        margin-top: 32px;
      }

      .detail-recommend-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 8px;
      }

      .detail-section-title {
        font-size: 16px;
        font-weight: 600;
      }

      .detail-recommend-viewport {
        overflow: hidden;
        padding: 4px 8px 12px;
      }

      .detail-recommend-track {
        display: flex;
        gap: 16px;
        scroll-behavior: smooth;
      }

      /* å•ä¸ªæ¨èå¡ç‰‡ï¼ˆå¤§å›¾ + æ–‡å­— + åŠ å…¥è´­ç‰©è½¦ï¼‰ */
      .detail-recommend-card {
        flex: 0 0 320px;
        background: #ffffff;
        border-radius: 18px;
        box-shadow: 0 12px 30px rgba(15, 23, 42, 0.10);
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }

      .detail-recommend-img-wrap {
        position: relative;
        width: 100%;
        padding-top: 62%;
        background: #f3f4f6;
        overflow: hidden;
      }

      .detail-recommend-img {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .detail-recommend-top-badge {
        position: absolute;
        left: 12px;
        top: 12px;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 11px;
        background: #f97316;
        color: #fff;
      }

      .detail-recommend-body {
        padding: 10px 14px 14px;
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .detail-recommend-name {
        font-size: 14px;
        font-weight: 600;
        margin-bottom: 2px;
      }

      .detail-recommend-desc {
        font-size: 12px;
        color: #6b7280;
      }

      .detail-recommend-price-row {
        display: flex;
        align-items: baseline;
        gap: 6px;
        margin-top: 4px;
      }

      .detail-recommend-price {
        font-size: 18px;
        font-weight: 700;
        color: #16a34a;
      }

      .detail-recommend-origin {
        font-size: 12px;
        text-decoration: line-through;
        color: #9ca3af;
      }

      .detail-recommend-bottom-row {
        margin-top: 8px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 6px;
      }

      .detail-recommend-fav-btn {
        border-radius: 999px;
        border: 1px solid #e5e7eb;
        background: #ffffff;
        padding: 6px 12px;
        font-size: 12px;
        cursor: pointer;
      }

      .detail-recommend-add-btn {
        flex: 1;
        border-radius: 999px;
        border: none;
        padding: 8px 14px;
        font-size: 13px;
        font-weight: 600;
        background: linear-gradient(135deg, #22c55e, #16a34a);
        color: #ffffff;
        cursor: pointer;
      }

      /* å·¦å³ç®­å¤´æŒ‰é’® */
      .detail-recommend-arrows {
        display: flex;
        gap: 6px;
      }

      .detail-rec-arrow {
        width: 30px;
        height: 30px;
        border-radius: 999px;
        border: 1px solid #e5e7eb;
        background: #ffffff;
        font-size: 18px;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }

      .detail-rec-arrow:disabled {
        opacity: 0.4;
        cursor: default;
      }

      /* çª„å±æ—¶å¡ç‰‡å˜å®½åº¦ 100%ï¼Œç®­å¤´éšè— */
      @media (max-width: 768px) {
        .detail-recommend-card {
          flex: 0 0 80%;
        }
        .detail-recommend-arrows {
          display: none;
        }
      }

      .detail-breadcrumb {
        font-size: 12px;
        color: #6b7280;
        margin-bottom: 10px;
      }
      .detail-breadcrumb a {
        color: #2563eb;
        text-decoration: none;
      }
      .detail-layout {
        display: grid;
        grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.2fr);
        gap: 24px;
      }
      @media (max-width: 900px) {
        .detail-layout {
          grid-template-columns: minmax(0, 1fr);
        }
      }

      .detail-image-box {
        background: #f3f4f6;
        border-radius: 16px;
        min-height: 260px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 13px;
        color: #6b7280;
        position: relative;
        overflow: hidden;
      }

      /* âœ… æ–°å¢ï¼šä¸»å›¾ */
      #detailImage {
        width: 100%;
        height: 100%;
        min-height: 260px;
        object-fit: cover;
        display: none;
      }

      .detail-tag-row {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        margin-bottom: 8px;
      }
      .detail-tag {
        font-size: 11px;
        padding: 2px 8px;
        border-radius: 999px;
        background: #ecfdf3;
        color: #15803d;
      }
      .detail-title {
        font-size: 20px;
        font-weight: 700;
        margin-bottom: 6px;
      }
      .detail-desc {
        font-size: 13px;
        color: #4b5563;
        margin-bottom: 10px;
      }
      .detail-price-row {
        display: flex;
        align-items: baseline;
        gap: 8px;
        margin-bottom: 8px;
      }
      .detail-price {
        font-size: 22px;
        font-weight: 700;
        color: #16a34a;
      }
      .detail-origin {
        font-size: 13px;
        text-decoration: line-through;
        color: #9ca3af;
      }
      .detail-extra-note {
        font-size: 12px;
        color: #fb923c;
        margin-bottom: 14px;
      }

      /* ===== å¤§èƒ¶å›ŠåŠ å…¥è´­ç‰©è½¦ + æ”¶è— ===== */
      .detail-cart-cta-row {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-top: 14px;
        margin-bottom: 10px;
      }

      .detail-big-cart-btn {
        flex: 1;
        display: inline-flex;
        align-items: center;
        justify-content: space-between;
        border-radius: 999px;
        background: #06b6d4;
        background: linear-gradient(90deg, #0ea5e9, #06b6d4);
        color: #fff;
        padding: 8px 10px;
        cursor: pointer;
        border: none;

        /* âœ… å…³é”®ï¼šå¾½ç« å®šä½ */
        position: relative;
      }

      /* âœ… æ–°å¢ï¼šèƒ¶å›Šæ•°é‡å¾½ç«  */
      #detailCartBadge {
        position: absolute;
        top: -8px;
        right: -8px;
        min-width: 22px;
        height: 22px;
        padding: 0 6px;
        border-radius: 999px;
        background: #ef4444;
        color: #fff;
        font-size: 12px;
        font-weight: 800;
        display: none;
        align-items: center;
        justify-content: center;
        box-shadow: 0 10px 18px rgba(15,23,42,0.25);
      }

      .detail-big-cart-btn:active {
        transform: translateY(1px);
        box-shadow: 0 0 0 transparent;
      }
      .detail-big-cart-icon {
        border-radius: 999px;
        width: 32px;
        height: 32px;
        border: none;
        background: rgba(15, 23, 42, 0.15);
        color: #fff;
        font-size: 18px;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
      }
      .detail-big-cart-text {
        flex: 1;
        padding: 0 8px;
        text-align: center;
      }
      .detail-big-cart-main {
        font-size: 14px;
        font-weight: 700;
      }
      .detail-big-cart-sub {
        font-size: 11px;
        opacity: 0.9;
      }
      .detail-fav-circle {
        width: 40px;
        height: 40px;
        border-radius: 999px;
        border: 1px solid #e5e7eb;
        background: #fff;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-size: 18px;
      }
      .detail-small-note {
        font-size: 11px;
        color: #6b7280;
      }
      .detail-back-row {
        margin-top: 10px;
      }
      .detail-btn-secondary {
        border-radius: 999px;
        border: 1px solid #e5e7eb;
        padding: 8px 14px;
        font-size: 13px;
        background: #ffffff;
        cursor: pointer;
      }

      .detail-empty {
        font-size: 13px;
        color: #6b7280;
      }
    </style>
  </head>
  <body>
    <!-- é¡¶éƒ¨å¯¼èˆªï¼ˆå¤ç”¨ï¼‰ -->
    <div class="top-nav">
      <div class="top-nav-inner">
        <div class="logo-area">
          <div class="logo-badge">é²œ</div>
          <div>
            <div class="logo-text-main">Freshbuy åœ¨é²œè´­æ‹¼å¥½è´§</div>
            <div class="logo-text-sub">
              æ–°é²œè‰åŸåŒºåŸŸ Â· æ¬¡æ—¥è¾¾ / æ¯å‘¨åŒºåŸŸå›¢é…
            </div>
          </div>
        </div>

        <div class="search-area">
          <div class="search-box">
            <span class="search-icon">ğŸ”</span>
            <input
              id="searchInput"
              class="search-input"
              placeholder="æœç´¢å•†å“ï¼Œå¦‚ï¼šé¸¡è…¿ã€ç‰›å¥¶ã€è‹¹æœ..."
            />
          </div>
        </div>

        <div class="user-area">
          <button class="link-btn">ç™»å½•</button>
          <button class="link-btn primary">æ³¨å†Œ</button>

          <!-- âœ… å…³é”®ï¼šåŠ  id="cartIcon"ï¼Œä¿æŒ onclick ä¸å˜ -->
          <div class="cart-icon" id="cartIcon" onclick="toggleCartDrawer()">
            ğŸ›’
            <span id="cartCountBadge" class="cart-count-badge">0</span>
          </div>
        </div>
      </div>
    </div>

    <main class="detail-page">
      <div class="detail-breadcrumb">
        <a href="index.html">é¦–é¡µ</a> /
        <span id="crumbProductName">å•†å“è¯¦æƒ…</span>
      </div>

      <!-- è¯¦æƒ…ä¸»ä½“ï¼šä¸¤åˆ—å¸ƒå±€ -->
      <div class="detail-layout">
        <!-- å·¦ä¾§ï¼šå›¾ç‰‡ / æ ‡ç­¾ -->
        <div class="detail-image-box">
          <!-- âœ… æ–°å¢ï¼šä¸»å›¾ -->
          <img id="detailImage" alt="å•†å“å›¾ç‰‡" />
          <span id="detailImageText">å•†å“å›¾å ä½ Â· åç»­æ¥çœŸå®å›¾ç‰‡</span>
        </div>

        <!-- å³ä¾§ï¼šæ ‡é¢˜ / ä»·æ ¼ / å¤§æŒ‰é’® / æ”¶è— / è¿”å›é¦–é¡µ -->
        <div>
          <div class="detail-tag-row" id="detailTagRow"></div>

          <div class="detail-title" id="detailTitle">åŠ è½½ä¸­...</div>
          <div class="detail-desc" id="detailDesc"></div>

          <div class="detail-price-row">
            <span class="detail-price" id="detailPrice">$0.00</span>
            <span class="detail-origin" id="detailOrigin"></span>
          </div>

          <div class="detail-extra-note" id="detailExtraNote"></div>

          <!-- æ•°é‡ + å¤§èƒ¶å›ŠåŠ å…¥è´­ç‰©è½¦ + æ”¶è— -->
          <div class="detail-cart-cta-row">
            <!-- å¤§èƒ¶å›ŠæŒ‰é’®ï¼ˆæ•´ä¸ªéƒ½æ˜¯â€œåŠ å…¥è´­ç‰©è½¦â€ï¼‰ -->
            <div class="detail-big-cart-btn" id="btnAddToCartDetail" type="button">
              <!-- âœ… æ–°å¢ï¼šèƒ¶å›Šå³ä¸Šè§’å¾½ç«  -->
              <span id="detailCartBadge">0</span>

              <button class="detail-big-cart-icon" type="button" id="btnQtyMinusBig">âˆ’</button>

              <div class="detail-big-cart-text">
                <div class="detail-big-cart-main" id="detailCartMainText">åŠ å…¥ 1 ä»¶å•†å“</div>
                <div class="detail-big-cart-sub" id="detailCartSubText">ç‚¹å‡»ä¸­é—´åŒºåŸŸåŠ å…¥è´­ç‰©è½¦</div>
              </div>

              <button class="detail-big-cart-icon" type="button" id="btnQtyPlusBig">+</button>
            </div>

            <!-- å³ä¾§åœ†å½¢æ”¶è—æŒ‰é’® -->
            <button class="detail-fav-circle" type="button" id="btnDetailFav">â™¡</button>
          </div>

          <div class="detail-small-note">
            å½“å‰ä¸º Freshbuy v0.1 æµ‹è¯•é¡µé¢ï¼šåŠ å…¥è´­ç‰©è½¦åªä¼šæ›´æ–°æœ¬åœ°çŠ¶æ€ï¼Œä¸ä¼šçœŸå®æ‰£æ¬¾ã€‚
          </div>

          <div class="detail-back-row">
            <button class="detail-btn-secondary" type="button" onclick="window.location.href='index.html'">
              è¿”å›é¦–é¡µç»§ç»­é€›
            </button>
          </div>
        </div>
      </div>

      <!-- æ¨èåŒºï¼šå¯å·¦å³æ»‘åŠ¨ -->
      <section class="detail-recommend-section">
        <div class="detail-recommend-header">
          <div class="detail-section-title">ä½ å¯èƒ½è¿˜ä¼šæƒ³ä¹°</div>
          <div class="detail-recommend-arrows">
            <button type="button" class="detail-rec-arrow" id="recPrev">â€¹</button>
            <button type="button" class="detail-rec-arrow" id="recNext">â€º</button>
          </div>
        </div>

        <div class="detail-recommend-viewport">
          <div id="recommendList" class="detail-recommend-track"></div>
        </div>
      </section>
    </main>

    <!-- è´­ç‰©è½¦ä¾§è¾¹æ ï¼ˆå¤ç”¨ï¼‰ -->
    <div id="cartBackdrop" class="cart-drawer-backdrop" onclick="toggleCartDrawer(false)"></div>
    <div id="cartDrawer" class="cart-drawer">
      <div class="cart-header">
        <div class="cart-title">è´­ç‰©è½¦</div>
        <button class="cart-close" onclick="toggleCartDrawer(false)">âœ•</button>
      </div>
      <div id="cartBody" class="cart-body">
        <div class="cart-empty">è´­ç‰©è½¦è¿˜æ˜¯ç©ºçš„ï¼Œå»é€›é€›å§ï½</div>
      </div>
      <div class="cart-footer">
        <div class="line">
          <span>å•†å“å°è®¡</span>
          <span id="cartSubtotal">$0.00</span>
        </div>
        <div class="line">
          <span>é¢„ä¼°è¿è´¹</span>
          <span id="cartShipping">$0.00</span>
        </div>
        <div class="line line-total">
          <span>è®¢å•æ€»é‡‘é¢</span>
          <span id="cartTotal">$0.00</span>
        </div>

        <div class="shipping-modes">
          <div>é€‰æ‹©é…é€æ¨¡å¼ï¼š</div>
          <div class="mode-row">
            <label class="mode-pill-small">
              <input type="radio" name="shipMode" value="single" checked onchange="updateShippingMode()" />
              æ™®é€š 4.99
            </label>
            <label class="mode-pill-small">
              <input type="radio" name="shipMode" value="friend" onchange="updateShippingMode()" />
              å¥½å‹æ‹¼å•
            </label>
            <label class="mode-pill-small">
              <input type="radio" name="shipMode" value="area" onchange="updateShippingMode()" />
              åŒºåŸŸå›¢å…è¿è´¹
            </label>
            <label class="mode-pill-small">
              <input type="radio" name="shipMode" value="pickup" onchange="updateShippingMode()" />
              è‡ªæç‚¹ 0.99
            </label>
          </div>

          <div id="groupSizeWrap" class="group-size-select" style="display: none;">
            å¥½å‹æ‹¼åŒä¸€åœ°å€äººæ•°ï¼š
            <select id="groupSize" onchange="recalcCartTotals()">
              <option value="2">2 äºº</option>
              <option value="3">3 äºº</option>
              <option value="4">4 äºº</option>
            </select>
          </div>

          <div id="modeHintSmall" class="mode-hint-small">
            å½“å‰ï¼šæ™®é€šé…é€ï¼Œæ¯å•è¿è´¹ $4.99ã€‚
          </div>
        </div>

        <button id="checkoutBtn" class="btn-checkout" onclick="submitOrder()" disabled>
          å»ç»“ç®—ï¼ˆæµ‹è¯•ï¼‰
        </button>
        <div class="footer-note">
          å½“å‰ä¸ºæ¨¡å¼æµ‹è¯•é¡µé¢ï¼šä¸‹å•ä¿¡æ¯ä¼šå‘é€åˆ°æµ‹è¯•åç«¯ï¼Œä¸ä¼šçœŸå®æ‰£æ¬¾ã€‚
        </div>
      </div>
    </div>

    <!-- é¡¶éƒ¨â€œå·²åŠ å…¥è´­ç‰©è½¦â€æç¤ºæ¡ -->
    <div id="addToCartToast" class="add-cart-toast"></div>

    <!-- å…¬å…± JS + è¯¦æƒ…é¡µ JSï¼ˆé¡ºåºä¸è¦æ”¹ï¼‰ -->
    <script src="assets/js/products.js"></script>
    <script src="assets/js/cart.js"></script>
    <script src="assets/js/product_detail.js"></script>
    <script src="/user/components/footer.js"></script>
  </body>
</html>
