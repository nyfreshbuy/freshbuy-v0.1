<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>å®¶åº­å¿…å¤‡ - åœ¨é²œè´­</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="./assets/css/main.css?v=10" />

  <style>
    :root{
      --sticky-shadow: 0 4px 12px rgba(15,23,42,.08);
    }

    /* =========================================================
       âœ… å…³é”®ï¼šä¸€ä¸ªâ€œæ€» sticky å®¹å™¨â€åŒ…ä½ï¼ˆæ ‡é¢˜+åˆ†ç±»+æ’åºï¼‰
       ========================================================= */
    .sticky-header{
      position: sticky;
      top: 0;
      z-index: 200;            /* é«˜äºå•†å“å¡/overlay */
      background:#fff;
      transition: box-shadow .2s ease;
    }
    /* æ»šåŠ¨ååŠ é˜´å½±ï¼ˆæ›´ App æ„Ÿï¼‰ */
    .sticky-header.is-scrolled{
      box-shadow: var(--sticky-shadow);
    }

    .top-nav{
      position: relative;      /* â— ä¸å† stickyï¼ˆé¿å…å¤š sticky å åŠ ä¸ç¨³ï¼‰ */
      background:#fff;
      border-bottom:1px solid #eef2f7;
    }
    .top-nav-inner{
      max-width: 1400px; margin:0 auto; padding:10px 14px;
      display:flex; align-items:center; gap:12px; justify-content:space-between;
    }

    .logo-area{display:flex; align-items:center; gap:10px;}
    .logo-badge{
      width:40px;height:40px;border-radius:999px;
      background: radial-gradient(circle at 30% 30%, #22c55e, #16a34a);
      display:flex;align-items:center;justify-content:center;color:#fff;font-weight:900;
      box-shadow: 0 8px 18px rgba(34,197,94,.22);
      font-size:18px;
    }
    .logo-text-main{font-weight:900; font-size:18px;}
    .logo-sub{font-size:12px;color:#6b7280; margin-top:2px;}

    .right-actions{display:flex; align-items:center; gap:12px;}
    .back-home-btn{
      padding:10px 14px;
      border-radius:999px;
      border:1px solid #e5e7eb;
      background:#fff;
      font-size:14px;
      font-weight:700;
      cursor:pointer;
      white-space:nowrap;
    }

    .cart-icon{
      position:relative; width:46px;height:46px;border-radius:16px;
      background:#0f172a; display:flex;align-items:center;justify-content:center;
      color:#e5e7eb; cursor:pointer; user-select:none;
      box-shadow: 0 10px 18px rgba(15,23,42,.18);
      font-size:18px;
    }
    .cart-count-badge{
      position:absolute; top:-6px; right:-6px;
      background:#ef4444; color:#fff; font-size:11px; padding:2px 7px;
      border-radius:999px; min-width:22px; text-align:center; display:none;
      box-shadow: 0 6px 14px rgba(239,68,68,.25);
    }

    /* åˆ†ç±» + æ’åºæ ï¼ˆä»åœ¨ sticky-header å†…ï¼‰ */
    .filter-wrap{
      max-width:1400px; margin:0 auto; padding:10px 14px 12px;
      display:flex; gap:12px; align-items:center; justify-content:space-between;
      background:#fff;
    }
    .filter-bar{
      display:flex; gap:10px; overflow-x:auto;
      -webkit-overflow-scrolling: touch;
      padding-bottom:2px;
    }
    .filter-bar::-webkit-scrollbar{display:none;}

    .filter-pill{
      flex:0 0 auto;
      padding:10px 14px;
      border-radius:999px;
      border:1px solid #e5e7eb;
      background:#fff;
      font-size:14px;
      cursor:pointer;
      white-space:nowrap;
      font-weight:700;
    }
    .filter-pill.active{
      border-color:rgba(34,197,94,.9);
      background:linear-gradient(135deg,#ecfdf3,#dcfce7);
      color:#15803d;
      font-weight:900;
    }

    .sort-box{
      flex:0 0 auto;
      display:flex; align-items:center; gap:8px;
      font-size:13px; color:#6b7280;
      white-space:nowrap;
    }
    .sort-select{
      padding:10px 12px; border-radius:14px; border:1px solid #e5e7eb;
      background:#fff; font-size:14px; outline:none; font-weight:700;
    }

    /* é¡µé¢ä¸»ä½“ */
    .page{max-width:1400px; margin:0 auto; padding:14px 14px 30px;}
    .page-title{display:flex; align-items:flex-end; justify-content:space-between; gap:10px; margin:8px 0 12px;}
    .page-title h2{margin:0; font-size:18px;}
    .page-title .sub{color:#6b7280; font-size:12px;}

    /* Toast */
    .add-cart-toast{
      position:fixed; top:78px; left:50%;
      transform:translateX(-50%) translateY(-16px);
      background:#111827; color:#f9fafb;
      padding:7px 14px; border-radius:999px; font-size:12px;
      box-shadow:0 10px 22px rgba(15,23,42,.35);
      opacity:0; pointer-events:none;
      transition: opacity .25s ease, transform .25s ease;
      z-index:9999; white-space:nowrap;
    }
    .add-cart-toast.show{opacity:1; transform:translateX(-50%) translateY(0);}

    /* âœ… æœ¬é¡µå…œåº•ï¼šrenderer çš„åŠ å…¥è´­ç‰©è½¦æŒ‰é’®å¼ºåˆ¶ç»¿è‰² */
    .product-add-fixed{
      background:#22c55e !important;
      color:#fff !important;
      border:none !important;
      border-radius:14px !important;
      font-weight:900 !important;
      height:46px !important;
    }
    .product-add-fixed:disabled{opacity:.55 !important;}
    .overlay-btn.add{
      background:#22c55e !important;
      color:#fff !important;
      border:none !important;
      font-weight:900 !important;
    }
    .overlay-btn.add:disabled{opacity:.55 !important;}

    /* âœ… è´­ç‰©è½¦æŠ½å±‰ï¼ˆå¦‚æœ main.css æ²¡æœ‰ä¹Ÿèƒ½ç”¨ï¼‰ */
    .cart-backdrop{
      position:fixed; inset:0; background:rgba(15,23,42,.45);
      display:none; z-index: 9998;
    }
    .cart-backdrop.active{display:block;}

    .cart-drawer{
      position:fixed; right:0; top:0; height:100vh; width:360px; max-width:92vw;
      background:#fff; box-shadow:-12px 0 30px rgba(15,23,42,.18);
      transform:translateX(110%); transition:transform .25s ease;
      z-index: 9999; display:flex; flex-direction:column;
      border-left:1px solid #eef2f7;
    }
    .cart-drawer.active{transform:translateX(0);}

    .cart-drawer-header{
      padding:12px 12px; display:flex; align-items:center; justify-content:space-between;
      border-bottom:1px solid #eef2f7;
    }
    .cart-close-btn{
      width:36px; height:36px; border-radius:12px;
      border:1px solid #e5e7eb; background:#fff; cursor:pointer;
      font-weight:900;
    }

    .cart-drawer-body{padding:12px; overflow:auto; flex:1;}
    .cart-empty{padding:12px; color:#6b7280; font-size:13px;}
    .cart-items{display:flex; flex-direction:column; gap:10px;}

    .cart-drawer-footer{
      padding:12px; border-top:1px solid #eef2f7;
    }
    .cart-go-btn{
      width:100%; height:46px; border:none; border-radius:14px;
      background:#0f172a; color:#fff; font-weight:900; cursor:pointer;
    }

    /* æ‰‹æœºç«¯ç»†èŠ‚ä¼˜åŒ– */
    @media (max-width: 520px){
      .top-nav-inner{padding:12px 12px;}
      .filter-wrap{padding:10px 12px 12px;}
      .back-home-btn{padding:10px 12px;}
      .logo-text-main{font-size:18px;}
    }
  </style>
</head>

<body>

  <!-- âœ… å¸é¡¶æ€»å®¹å™¨ï¼šæˆªå›¾åŒºåŸŸâ€œå§‹ç»ˆåœ¨å±å¹•ä¸Šâ€ -->
  <div class="sticky-header" id="stickyHeader">
    <header class="top-nav">
      <div class="top-nav-inner">
        <div class="logo-area" onclick="location.href='/user/index.html'" style="cursor:pointer;">
          <div class="logo-badge">é²œ</div>
          <div>
            <div class="logo-text-main">å®¶åº­å¿…å¤‡ä¸“åŒº</div>
            <div class="logo-sub">å¸¸å¤‡æ¸…å• Â· é«˜é¢‘å¤è´­ Â· ä¸€ç«™è¡¥é½</div>
          </div>
        </div>

        <div class="right-actions">
          <button type="button" class="back-home-btn" onclick="location.href='/user/index.html'">
            â† è¿”å›é¦–é¡µ
          </button>

          <div class="cart-icon" id="cartIcon" title="æ‰“å¼€è´­ç‰©è½¦">
            ğŸ›’
            <span class="cart-count-badge" id="cartCount">0</span>
          </div>
        </div>
      </div>

      <!-- åˆ†ç±» pills + æ’åºï¼ˆJS ä¼šå¾€ #filterBar å¡æŒ‰é’®ï¼‰ -->
      <div class="filter-wrap">
        <div class="filter-bar" id="filterBar"></div>

        <div class="sort-box">
          <span>æ’åº</span>
          <select class="sort-select" id="sortSelect">
            <option value="sales_desc">é”€é‡é«˜ â†’ ä½</option>
            <option value="price_asc">ä»·æ ¼ä½ â†’ é«˜</option>
            <option value="price_desc">ä»·æ ¼é«˜ â†’ ä½</option>
          </select>
        </div>
      </div>
    </header>
  </div>

  <div class="add-cart-toast" id="addCartToast">å·²åŠ å…¥è´­ç‰©è½¦</div>

  <main class="page">
    <div class="page-title">
      <div>
        <h2>ğŸ  å®¶åº­å¿…å¤‡</h2>
        <div class="sub">å®¶åº­å¿…å¤‡ = æ‰€æœ‰ç‰¹ä»·å•†å“ï¼ˆåå°å¼€å¯ç‰¹ä»·å³å¯å‡ºç°ï¼‰</div>
      </div>
    </div>

    <div class="product-grid" id="dailyGrid"></div>
  </main>

  <!-- âœ… è´­ç‰©è½¦æŠ½å±‰ DOMï¼ˆä¿è¯ cartIcon ç‚¹å‡»ä¸€å®šæœ‰æ•ˆï¼‰ -->
  <div class="cart-backdrop" id="cartBackdrop"></div>

  <aside class="cart-drawer" id="cartDrawer" aria-hidden="true">
    <div class="cart-drawer-header">
      <div style="font-weight:900;">è´­ç‰©è½¦</div>
      <button type="button" class="cart-close-btn" id="cartCloseBtn">âœ•</button>
    </div>

    <div class="cart-drawer-body">
      <div style="font-size:12px;color:#6b7280; margin-bottom:10px;">
        å…± <span id="cartTotalItems">0</span> ä»¶
      </div>

      <div class="cart-empty" id="cartEmptyText" style="display:none;">
        è´­ç‰©è½¦è¿˜æ˜¯ç©ºçš„ï¼Œå¿«å»æŒ‘ç‚¹å¥½ä¸œè¥¿ï½
      </div>

      <div class="cart-items" id="cartItemsList"></div>
    </div>

    <div class="cart-drawer-footer">
      <button type="button" class="cart-go-btn" id="goCartBtn">å»è´­ç‰©è½¦ç»“ç®—</button>
    </div>
  </aside>

  <!-- âœ… è„šæœ¬é¡ºåºï¼šcart.js â†’ renderer â†’ page -->
  <script src="/user/assets/js/cart.js?v=10"></script>
  <script src="/user/assets/js/product_card_renderer.js?v=2"></script>
  <script src="/user/assets/js/DailySpecial.js?v=3"></script>

  <!-- âœ… æ»šåŠ¨é˜´å½±ï¼šæ›´ App æ„Ÿ -->
  <script>
    (function () {
      const header = document.getElementById("stickyHeader");
      if (!header) return;

      function onScroll() {
        if (window.scrollY > 4) header.classList.add("is-scrolled");
        else header.classList.remove("is-scrolled");
      }

      window.addEventListener("scroll", onScroll, { passive: true });
      onScroll();
    })();
  </script>

</body>
</html>
